<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>用户管理</title>
  <script>
    async function login() {
      const username = document.getElementById("login-username").value;
      const password = document.getElementById("login-password").value;

      const res = await fetch("/user/login", {
        method: "POST",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body: `username=${username}&password=${password}`
      });

      const data = await res.json();
      alert(JSON.stringify(data));
    }

    async function register() {
      const user = {
        username: document.getElementById("register-username").value,
        password: document.getElementById("register-password").value,
        ID_num: document.getElementById("register-idnum").value,
        email: document.getElementById("register-email").value,
        phone: document.getElementById("register-phone").value,
        signature: document.getElementById("register-signature").value
      };

      const res = await fetch("/user/register", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(user)
      });

      const data = await res.json();
      alert(JSON.stringify(data));
    }

    async function getUserInfo() {
      const username = document.getElementById("userinfo-username").value;

      const res = await fetch("/user/getUserInfo", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ username })
      });

      const data = await res.json();
      document.getElementById("user-result").innerText = JSON.stringify(data);
    }

    async function updateUser() {
      const user = {
        userId: document.getElementById("update-userid").value,
        username: document.getElementById("update-username").value,
        password: document.getElementById("update-password").value,
        ID_num: document.getElementById("update-idnum").value,
        email: document.getElementById("update-email").value,
        phone: document.getElementById("update-phone").value,
        signature: document.getElementById("update-signature").value
      };

      const res = await fetch("/user/updateUserInfo", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(user)
      });

      const data = await res.json();
      alert(JSON.stringify(data));
    }

    async function deleteUser() {
      const username = document.getElementById("delete-username").value;

      const res = await fetch("/user/deleteUser", {
        method: "POST",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body: `username=${username}`
      });

      const data = await res.json();
      alert(JSON.stringify(data));
    }
  </script>
</head>
<body>
<h2>登录</h2>
用户名：<input id="login-username"><br>
密码：<input id="login-password" type="password"><br>
<button onclick="login()">登录</button>

<hr>

<h2>注册</h2>
用户名：<input id="register-username"><br>
密码：<input id="register-password" type="password"><br>
学工号：<input id="register-idnum"><br>
邮箱：<input id="register-email"><br>
手机：<input id="register-phone"><br>
签名：<input id="register-signature"><br>
<button onclick="register()">注册</button>

<hr>

<h2>获取用户信息</h2>
用户名：<input id="userinfo-username"><br>
<button onclick="getUserInfo()">查询</button><br>
<pre id="user-result"></pre>

<hr>

<h2>更新用户信息</h2>
用户ID：<input id="update-userid"><br>
用户名：<input id="update-username"><br>
密码：<input id="update-password" type="password"><br>
学工号：<input id="update-idnum"><br>
邮箱：<input id="update-email"><br>
手机：<input id="update-phone"><br>
签名：<input id="update-signature"><br>
<button onclick="updateUser()">更新</button>

<hr>

<h2>删除用户</h2>
用户名：<input id="delete-username"><br>
<button onclick="deleteUser()">删除</button>
</body>
</html>